# Household Energy Prediction 

## Project Overview
This project focuses on forecasting household electricity usage. The approach combines feature engineering, time series modeling, and an ensemble machine learning strategy to deliver accurate and actionable predictions.

## Submission Contents
- **household_energy_prediction_final.ipynb**  
  The main Jupyter notebook containing all code, analysis, and results. This notebook is fully self-contained and documents the workflow from data preprocessing to model evaluation and business insights.

- **ensemble_feature_list.joblib**  
  Serialized list of features used in the final ensemble model.

- **peak_classifier.joblib**  
  Trained LightGBM classifier for detecting peak (high-usage) periods.

- **regressor_nonpeak.joblib**  
  Trained LightGBM regressor for non-peak periods.

- **regressor_peak.joblib**  
  Trained LightGBM quantile regressor for peak periods.

- **predictions.csv**  
  Final predictions for the holdout set, as generated by the ensemble model pipeline.

- **requirements.txt**  
  List of Python package dependencies required to run the notebook and reproduce results.

## How to Run
1. **Open the Notebook**  
   Launch `household_energy_prediction_final.ipynb` in Jupyter Notebook or JupyterLab.

2. **Install Dependencies**  
   Install required packages using:
   ```bash
   pip install -r requirements.txt
   ```

3. **Run the Notebook**  
   Execute all cells in order. The notebook will:
   - Load and preprocess the data
   - Perform exploratory data analysis (EDA)
   - Engineer features for time series modeling
   - Train and evaluate multiple models, including the final ensemble
   - Generate and save predictions to `predictions.csv`
   - Provide business insights and discuss limitations

4. **Review Results**  
   - Model performance metrics and visualizations are included in the notebook.
   - The final predictions for the holdout set are saved in `predictions.csv`.

## Methodology Summary
- **Data Preprocessing:** Careful handling of missing values, outlier analysis, and time-based feature extraction.
- **Feature Engineering:** Creation of lagged, rolling, and interaction features to capture temporal patterns and external influences while preventing data leakage.
- **Modeling Approach:**
  - Ensemble of LightGBM models:
    - Classifier to detect peak periods
    - Separate regressors for peak and non-peak periods
    - Quantile regression and oversampling to improve peak prediction
  - Recursive evaluation to mimic real-world deployment.

## Business Insights
The notebook concludes with a discussion of risks, limitations, and practical applications of household energy forecasting for utilities, financial institutions, and consumers. Key use cases include demand response, grid optimization, investment risk assessment, renewable integration, dynamic pricing, and personalized energy recommendations.

## Contact
For questions or clarifications, please refer to the comments and markdown cells within `household_energy_prediction_final.ipynb`.

---

**Note:** Only the files listed above are included in this submission. All code and results are contained within `household_energy_prediction_final.ipynb` and the accompanying model and output files. 